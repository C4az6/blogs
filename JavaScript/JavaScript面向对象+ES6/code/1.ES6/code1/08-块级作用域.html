<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    /* 
      思考：
        1.为什么需要快级作用域？
        因为ES5中只有全局作用域和函数作用域，没有块级作用域，导致很多出现很多不合理场景

    
     */


    // 1.第一种场景，内层变量可能会覆盖外层变量
    //  var tmp = Date.now();
    //  function f(){
    //    console.log(tmp)
    //    if(false) {
    //      var tmp = "hello world"
    //    }
    //  }

    //  f();   // undefined

    /* 
     上面代码的原意是，if代码块的外部使用外层的tmp变量，内部使用内层的tmp变量。
     但是，函数f执行后，输出结果为undefined，原因在于变量提升，导致内层的tmp变量覆盖了外层的tmp变量。
     我的理解就是调用f函数之后，要打印的tmp变量会进行变量提升，此时值为undefined，覆盖了全局的tmp，于是输出的结果为undefined。
     */


    // 2.用来计数的循环变量泄漏为全局变量
    // var s = 'hello'
    // for(var i=0; i<s.length; i++) {
    //   console.log(s[i]);
    // }
    // console.log(i)    // 5
    /* 
      上面代码中，变量i只是用来控制循环，但是循环结束后，他并没有消失，泄露成了全局变量。
     */



    // ================================================= //
    // ES6的块级作用域

    // 1.let的块级作用域
    // function fn() {
    //   let n = 5;
    //   if (true) {
    //     let n = 10;
    //   }
    //   console.log(n); // 5
    // }
    // fn();

    // 使用var实现上面功能
    // function fn() {
    //   var n = 5;
    //   if (true) {
    //     var n = 10;
    //   }
    //   console.log(n); // 10
    // }
    // fn();

    /* 
      上面的函数有两个代码块，都声明了变量n，运行后输出 5。这表示外层代码块不受内层代码块的影响。如果两次都使用var定义变量n，最后输出的值才是 10。
     */

    // 2.ES6允许块级作用域的任意嵌套
    //  {{{{
    //    {let insane = 'Hello World'}
    //    console.log(insane);   // 报错
    //  }}}}
    /* 
     上面代码使用了一个五层的块级作用域，每一层都是一个单独的作用域。第四层作用域无法读取第五层作用域的内部变量。
     */

    // 内层作用域可以定义外层作用域的同名变量
    // {{{{
    //   let say = "fuck you";
    //   {let say = "fuck you"}
    //   console.log(say)    
    // }}}}

    // 3.块级作用域的出现，实际上使得获得广泛应用的匿名立即执行函数表达式（匿名 IIFE）不再必要了。
    // (function(){
    //   var tmp = 123;
    //   console.log(tmp)
    // })()

    // 块级作用域写法
    // {
    //   let tmp = 123;
    //   console.log(tmp)
    // }


  </script>
</body>

</html>